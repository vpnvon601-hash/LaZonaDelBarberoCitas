<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reservar Cita - LA ZONA DEL BARBERO</title>
    <!-- Carga de Tailwind CSS para un diseño responsivo y moderno --><script src="https://cdn.tailwindcss.com"></script>
    <!-- Fuente Inter de Google Fonts para un toque profesional --><link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Configuración de color para la paleta negro/blanco/gris --><script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Paleta monocromática ajustada para un look más profesional
                        'primary-dark': '#121212',       // Fondo principal muy oscuro
                        'secondary-dark': '#1E1E1E',     // Fondo del contenedor principal
                        'accent-gray': '#4a4a4a',        // Bordes y separadores sutiles
                        'text-light': '#E0E0E0',         // Texto claro para contraste
                        'text-white': '#FFFFFF',         // Blanco puro para títulos
                        'input-bg': '#2C2C2C',           // Fondo de los inputs
                        'button-bg': '#FFFFFF',          // Fondo del botón principal
                        'button-text': '#121212',        // Texto del botón principal
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'], // Usar Inter como fuente principal
                    }
                },
            },
        }
    </script>
    <style>
        /* Estilos generales para la aplicación */
        body {
            font-family: 'Inter', sans-serif;
            background-color: theme('colors.primary-dark'); /* Fondo muy oscuro profesional */
            color: theme('colors.text-light'); /* Color de texto por defecto */
        }
        /* Estilos para inputs y selects, con bordes redondeados y fondo oscuro */
        .form-input, .form-select {
            @apply w-full p-3 border rounded-xl bg-input-bg border-accent-gray text-text-light 
                   focus:outline-none focus:ring-2 focus:ring-text-white focus:border-transparent 
                   transition-colors duration-200;
        }
        .form-label {
            @apply block text-sm font-medium text-text-light mb-1;
        }
        /* Ajuste para el color del icono del calendario nativo */
        input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(1); 
        }
        input[type="date"] {
            color-scheme: dark; 
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">
    <!-- Contenedor principal con fondo gris oscuro y bordes redondeados --><div class="w-full max-w-xl bg-secondary-dark p-8 md:p-10 rounded-2xl shadow-xl border border-accent-gray">
        <h1 class="text-4xl font-extrabold text-text-white mb-2 text-center">
            LA ZONA DEL BARBERO
        </h1>
        <p class="text-center text-sm text-text-light mb-8 opacity-90">
            Programa tu próxima cita con nuestros especialistas y luce tu mejor estilo.
        </p>

        <form id="appointmentForm" class="space-y-6">
            <!-- Sección de Datos Personales --><div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label for="nombre" class="form-label">Nombre</label>
                    <input type="text" id="nombre" class="form-input" required>
                </div>
                <div>
                    <label for="apellido" class="form-label">Apellido</label>
                    <input type="text" id="apellido" class="form-input" required>
                </div>
                <div>
                    <label for="numero" class="form-label">Número de Teléfono</label>
                    <input type="tel" id="numero" class="form-input" pattern="[0-9]{7,15}" title="Ingresa un número de teléfono válido (7 a 15 dígitos)." required>
                </div>
                <div>
                    <label for="correo" class="form-label">Correo Electrónico</label>
                    <input type="email" id="correo" class="form-input" required>
                </div>
            </div>

            <!-- Sección de Barbero y Servicio --><div class="grid grid-cols-1 md:grid-cols-2 gap-4 pt-6 border-t border-accent-gray">
                <div>
                    <label for="barbero" class="form-label">Barbero</label>
                    <select id="barbero" class="form-select" required>
                        <option value="">Selecciona un barbero</option>
                    </select>
                </div>
                <div>
                    <label for="servicio" class="form-label">Servicio</label>
                    <select id="servicio" class="form-select" onchange="updateTimeSlots()" required>
                        <option value="">Selecciona un servicio</option>
                    </select>
                </div>
            </div>

            <!-- Sección de Calendario y Hora --><div>
                <h2 class="text-xl font-semibold text-text-white mb-4 pt-6 border-t border-accent-gray">Programar Fecha y Hora</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="fecha" class="form-label">Fecha</label>
                        <input type="date" id="fecha" class="form-input" onchange="updateTimeSlots()" required>
                    </div>

                    <div>
                        <label for="hora" class="form-label">Programar Hora</label>
                        <select id="hora" class="form-select" required disabled>
                            <option value="">Selecciona una hora</option>
                        </select>
                        <p id="slotMessage" class="text-xs mt-1 text-gray-500 hidden">Selecciona una fecha y un servicio para ver las horas disponibles.</p>
                    </div>
                </div>
            </div>
            
            <!-- Botón de Envío --><button type="submit" class="w-full bg-button-bg text-button-text font-bold py-3 px-4 rounded-xl 
                                       hover:bg-gray-200 transition duration-200 shadow-lg text-lg tracking-wide">
                Confirmar Cita (Enviar por WhatsApp)
            </button>

            <!-- Mensaje de estado --><div id="statusMessage" class="hidden p-3 mt-4 rounded-lg text-center text-sm font-medium bg-secondary-dark text-text-light border border-accent-gray"></div>

            <!-- Nota sobre Firebase --><p class="text-xs text-center text-gray-600 mt-6 pt-4 border-t border-accent-gray">
                Nota: La gestión de disponibilidad en tiempo real requiere una integración con Firebase.
            </p>
        </form>
    </div>

    <script>
        // --- CONFIGURACIÓN DE DATOS Y CONSTANTES ---

        const WHATSAPP_PHONE = '573233489369';

        const BARBERS = [
            { id: 'dylan', name: 'Dylan' },
            { id: 'santiago', name: 'Santiago' },
            { id: 'alejandro', name: 'Alejandro' },
            { id: 'leonardo', name: 'Leonardo' },
        ];

        const SERVICES = [
            { id: 'corte', name: 'Corte (18.000 COP)', price: '18.000 COP', duration: 30 },
            { id: 'corte-ceja', name: 'Corte + Ceja (22.000 COP)', price: '22.000 COP', duration: 40 },
            { id: 'corte-barba', name: 'Corte + Ceja + Barba (25.000 COP)', price: '25.000 COP', duration: 60 }, // 1 hora
            { id: 'corte-limpieza', name: 'Corte + Limpieza Facial (65.000 COP)', price: '65.000 COP', duration: 150 }, // 2.5 horas
        ];

        const START_TIME_MINUTES = 10 * 60; // 10:00 AM
        const END_TIME_MINUTES = 20 * 60 + 40; // 8:40 PM

        const form = document.getElementById('appointmentForm');
        const barberoSelect = document.getElementById('barbero');
        const servicioSelect = document.getElementById('servicio');
        const fechaInput = document.getElementById('fecha');
        const horaSelect = document.getElementById('hora');
        const slotMessage = document.getElementById('slotMessage');
        const statusMessage = document.getElementById('statusMessage');

        // --- FUNCIONES DE UTILIDAD ---

        function formatMinutesToTime(totalMinutes) {
            const hours = Math.floor(totalMinutes / 60);
            const minutes = totalMinutes % 60;
            const hour12 = hours % 12 || 12;
            const ampm = hours < 12 || hours === 24 ? 'AM' : 'PM';
            const minuteString = minutes < 10 ? '0' + minutes : minutes;
            return `${hour12}:${minuteString} ${ampm}`;
        }

        // --- LÓGICA DE LA APLICACIÓN ---

        function initializeApp() {
            BARBERS.forEach(barber => {
                const option = document.createElement('option');
                option.value = barber.id;
                option.textContent = barber.name;
                barberoSelect.appendChild(option);
            });

            SERVICES.forEach(service => {
                const option = document.createElement('option');
                option.value = service.id;
                option.textContent = service.name;
                servicioSelect.appendChild(option);
            });

            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            fechaInput.min = `${year}-${month}-${day}`;

            slotMessage.classList.remove('hidden');
        }

        function updateTimeSlots() {
            const selectedServiceId = servicioSelect.value;
            const selectedDate = fechaInput.value;
            
            horaSelect.innerHTML = '<option value="">Selecciona una hora</option>';
            horaSelect.disabled = true;
            slotMessage.textContent = 'Selecciona una fecha y un servicio para ver las horas disponibles.';
            slotMessage.classList.remove('hidden');

            if (!selectedServiceId || !selectedDate) {
                return; 
            }

            const service = SERVICES.find(s => s.id === selectedServiceId);
            if (!service) return; 

            const duration = service.duration;
            let currentTime = START_TIME_MINUTES;
            let slotsGenerated = false;

            while (currentTime + duration <= END_TIME_MINUTES) {
                const slotStartTime = formatMinutesToTime(currentTime);

                const option = document.createElement('option');
                option.value = slotStartTime;
                option.textContent = slotStartTime;
                horaSelect.appendChild(option);
                
                currentTime += duration; 
                slotsGenerated = true;
            }

            if (slotsGenerated) {
                horaSelect.disabled = false;
                slotMessage.classList.add('hidden');
            } else {
                slotMessage.textContent = 'No hay horas disponibles para este servicio en el día seleccionado.';
            }
        }

        async function handleFormSubmit(e) {
            e.preventDefault();
            statusMessage.classList.add('hidden');

            const nombre = document.getElementById('nombre').value;
            const apellido = document.getElementById('apellido').value;
            const numero = document.getElementById('numero').value;
            const correo = document.getElementById('correo').value;
            const barbero = barberoSelect.options[barberoSelect.selectedIndex].text;
            const servicioText = servicioSelect.options[servicioSelect.selectedIndex].text;
            const fecha = fechaInput.value;
            const hora = horaSelect.value;

            const formattedDate = new Date(fecha + 'T00:00:00').toLocaleDateString('es-CO', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });

            const mensaje = `
*NUEVA CITA - LA ZONA DEL BARBERO*

*DATOS PERSONALES:*
Nombre: ${nombre} ${apellido}
Teléfono: ${numero}
Correo: ${correo}

*DETALLES DE LA CITA:*
Barbero: ${barbero}
Servicio: ${servicioText}
Fecha: ${formattedDate}
Hora: ${hora}

Por favor, confirma mi cita. ¡Gracias!
            `.trim();

            const encodedMessage = encodeURIComponent(mensaje);
            const whatsappURL = `https://api.whatsapp.com/send?phone=${WHATSAPP_PHONE}&text=${encodedMessage}`;

            statusMessage.textContent = 'Redirigiendo a WhatsApp para confirmar la cita...';
            statusMessage.classList.remove('hidden');
            statusMessage.classList.add('bg-secondary-dark', 'text-text-light');

            window.open(whatsappURL, '_blank');

            setTimeout(() => {
                form.reset();
                updateTimeSlots(); 
                statusMessage.classList.add('hidden');
            }, 3000);
        }

        // --- LISTENERS DE EVENTOS ---
        window.onload = initializeApp;
        form.addEventListener('submit', handleFormSubmit);
    </script>
</body>
</html>

